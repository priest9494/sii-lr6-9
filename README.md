# СИИ Лабы 6, 7, 9 + РК 2

## ЛР 6 - сценарии
Диалог с чайным пьяницей

[пуэр/улун/черный чай/зеленый чай] = [1]

Список вопросов:

	1. При какой температуре заварить [1]?
		1. 1. Какова температура воды при заварке [1]?
	2. Сколько грамм [1] насыпать на кружку воды?
		2. 1. Сколько грамм [1] надо на одну кружку воды?
	3. Как правильно приготовить[1]?
		3. 1. Как приготовить [1]?
		3. 2. Как заваривать [1]?
		3. 3. Сколько заваривать [1]?
		3. 4. Сколько по времени заваривать [1]?
	4. Чем полезен[1]?
		4. 1. Чего полезного в [1]?
		4. 2. Какова польза  [1]?
	5. Какая средняя цена у [1]?
		5. 1. Сколько в среднем стоит [1]?
	6. Какой чай расслабляет?
		6. 1. Какой чай мне выпить чтобы расслабиться?
		6. 2. Подскажи мне расслабляющий чай
	7. Какой чай жмыхает?
		7. 1. Какой чай мне выпить чтобы жмыхнуло?
		7. 2. Подскажи мне крепкий чай
		7. 3. Какой чай выпить чтобы проснуться?
	8. Какой чай самый полезный?
		8. 1. Подскажи мне самый полезный чай
		8. 2. Какой чай наиболее полезен?
	9. Какой чай мне сейчас выпить?
		9. 1. Чего бы сейчас выпить?
	10. Какой чай можно пить на ночь?
	11. Какой чай нельзя пить на ночь?
  
  ## ЛР 7 - Диалоговая система
  Код, описание и демонстрация в файле [LR6.ipynb](https://github.com/priest9494/sii-lr6-9/blob/master/LR6.ipynb)
  
  ## ЛР 9 - Кастомизация мультимодального интерфейса
  ![Image alt](https://github.com/priest9494/sii-lr6-9/blob/master/teaman.jpg)
  
  Диалоговая система, помогающая выбрать чай. Идея в том, что ее можно прикрутить к чайному магазину с рекоммендательной системой (из РК1).
Это будет какое-то подобие очного посещения магазина, где консультант разговаривает с покупалетем, выдает какие-то реплики по тому или иному товару. ИИ будет сопровождать покупателя, выдавать разные реплики при просмотре каталогов или отдельных чаев.

Дружелюбный китаец поможет определиться с выбором, попутно развлекая анекдотами и китайскими мудрыми фразами. 

Также в качестве эксперимента можно придать ИИ небольшую иллюзию честности. Например, выбрать группу "чаев-жертв", при просмотре которых ИИ говорит пользователю что-то вроде "На вашем месте, я бы это не брал" или "Честно говоря, этот чай не очень". Есть вероятность, что после таких реплик пользователь начнет больше доверять рекомендациям

### Сценарии:
1. Приветствие

Пользователь заходит на сайт магазина, в правом углу выезжает наш китаец с репликой "Здравствуйте! Я могу помочь вам выбрать идеальный чай". Ищем положительные/отрицательные слова по типу (да, конечно / нет, исчезни). Отрицательный ответ приводит к сценарию 2. В случае, если пользователь вновь обращается к ИИ после отказа, будет альтернативное приветствие по типу "Чем я могу быть полезен?"

2. Отказ от диалога

В этом случае ИИ выдает фразу "Если что зовите, я буду тут". Окошко сворачивается, появляется возможность возобновления диалога.

3. Помощь в подборе чая

Пользоваеть спрашивает что-то вроде "Подбери мне чай". Тут начинается уточнение характеристик (цвет, вкус, запах, цена). Можно достаточно неплохо использовать двевовидную структуру онтологии из ЛР 1-2 для сужения круга рекомендаций.

4. Повторение ответа

Пользователь говорит, что что-то не понял/не расслышал. В этом случае ИИ повторяет реплику и добавляет несколько слов для разнообразия ответа по типу "Надеюсь, теперь вы поняли/расслышали" или "Я могу повторить еще раз".

5. Пользователь долго общается с ИИ (увлекся)

В момент, когда в диалоге набралось большое количество сообщений, ИИ подмечает этот факт и выдает какую-то фразу по типу "Кстате вы разговариваете со мной больше остальных. Если вас устраивает наш сайт, вы можете регнуться и подписаться на рассылку". В случае положительного ответа, происходит редирект.

6. Пользователь использовал нецензурную лексику

ИИ просит его больше так не делать. В случае частого повторения ИИ ответит "Ладно, я постараюсь не обращать на это внимание" (клиент всегда прав как-никак)

7. Ответ на "справочную информацию" по чаям (на один из вопросов ЛР 6)

Пользователю может понадобиться справочная информация по какому-то чаю, или про чаи впринципе. Возможные реплики были описаны в ЛР 6. Возможные ответы были описаны в ЛР 7.

8. Просьба рассказать анекдот

Возможно не самая полезная функция, но автору ИИ нравятся анекдоты. Анекдоты, само собой, на тематику чаев

9. Вброс какой-нибудь мудрой китайской цитаты

Например, пользователь выразился нецензурно и тут ИИ такая "Как говорил Конфуций, не говорите, если это не изменяет тишину к лучшему"

10. Уведомление о том, что вопрос непонятный

"Не очень понимаю ваш вопрос, можете попробовать задать его по-другому"

11. Уведомление о том, что вопрос не по теме

К вопросам не по теме можно отнести всякие популярные вопросы, задаваемые ИИ, когда хочется просто узнать, что он ответит. Примеры таких вопросов: "Как дела?", "Как настроение" и т. д. Можно сказать что-то вроде "Я создан исключительно для разговоров о чае". Хотя, возможно, не стоит подчеркивать ограниченность функционала и сказать "Давайте сосредоточимся на чае".

12. Ответ на просьбу что-то рекомендовать.

Ищем вопросы по типу "Что порекомундуешь?", "Порекомендуй мне что-нибудь" и т. д. Тут подключается РС из РК 1 и ИИ предлагает список чаев. Если корзина пользователя пуста, непонятно что рекомендовать и система переходит к сценарию 3 фразой "Вы не выбрали ни одного чая, давайте попробуем определить ваши вкусы и я найду для вас что-нибудь подходящее".

13. Рассказ о том, как правильно выбирать чай

Является ответом на вопросы по типу "Как мне лучше выбрать чай?", "С чего начать?".

14. ИИ больше не нужен пользователю

"Ты мне не нужен", "Спасибо, дальше разребусь сам". ИИ как и в случае отрицательного ответа в сценарии 1 отходит ожидать, пока ее снова не позовут с репликой "Хорошо. Если что, зовите".

15. Пользователь оплатил покупку

ИИ всячески благодарит за покупку и предлагает регнуться, чтобы запомнить предпочтения пользователя и сохранить контекст диалога.

16. Хотите анекдот?

Почему бы и нет

<b>Далее описаны сценарии, позволяющие ИИ помогать покупателю определиться с выбором товара</b> (Триггером для сценария является просмотр пользователем какого-то каталога или детальной информации по чаю)

17. ИИ не рекомендует брать это чай

Это тот кейс, который был предложен в начале описания

18. ИИ рекомендует каталог

"Основываясь на ваших предпочтениях я могу предположить, что этот каталог вам подходит"

19. ИИ рекомендует чай

"Основываясь на ваших предпочтениях я могу предположить, что этот чай вам подходит. У него такие-то свойства, которые вам нравятся"

20. ИИ рассказывает подробно про чай

Тут надо обзавестись описанием для каких-то часто просматриваемых чаев, чтобы ИИ смог его проговорить 


## РК 2 - Как написать скилл для Алисы и внедрить его

Чтобы научить Алису чему-то новому, нужно создать навык на платформе Яндекс.Диалоги:

- С точки зрения пользователя, навык — это специализированный режим Алисы, который вызывается определенным вами активационным именем. В этом режиме Алиса транслирует реплики пользователя на ваш сервер, и отвечает переданным вами текстом, ссылками или подсказками.
- С технической точки зрения, навык — это веб-сервис, который ожидает реплик пользователя от Яндекс.Диалогов. Веб-сервис можно писать на любом удобном вам языке программирования или веб-фреймворке — он должен только корректно отвечать на запросы Диалогов.

Чтобы ваш навык был доступен в Алисе:
- Разработайте и протестируйте веб-сервис, который сможет отвечать на запросы Яндекс.Диалогов. Для начала можно использовать примеры простых навыков для Node.js и Python.
- Опубликуйте навык на Яндекс.Диалогах.

У навыков для Алисы есть три составляющих: сценарий, контент (данные, к которым обращается навык) и код. Сценарий описывает фразы, которые может произносить пользователь, и то, как навык будет на них реагировать. Для того, чтобы понять, как будет идти диалог, можно сначала нарисовать простую схему на листе бумаги. «Для создания сценария удобно использовать визуальные конструкторы: например, AImylogic. С помощью конструктора можно увидеть, как будут работать переходы в диалоге, и протестировать навык».
Главные слова в навыке — это приветственная фраза. От того, насколько хорошо она составлена, зависит, будут ли пользователи пользоваться вашим навыком. Люди не привыкли к голосовым интерфейсам и ждут от них естественного общения. Поэтому важно с самого начала направить их в нужном направлении.
В первой реплике нужно объяснить, что навык умеет: например, если это игра, то описать её правила. Ещё в первом сообщении важно проговорить пользователю, что именно ему нужно делать. Закончить фразу лучше вопросом, который будет побуждать пользователя к действию.
Технически навык очень похож на бота, но с тем отличием, что он не может сам отправлять сообщения — только отвечать на запросы пользователя. Для того, чтобы запустить навык, нужно подготовить исходный код (например, на Python или на Node.js) и развернуть веб-сервис.
Для развёртывания навыка можно использовать сервис Now: он позволяет быстро запустить нужное веб-приложение, но ограничивает удобство разработки и тестирования. А чтобы запустить сервис в условиях, приближенных к боевым, можно воспользоваться Microsoft Azure, Amazon Web Services или Яндекс.Облаком. Так, Облако выдаёт всем создателям навыков гранты на использование сервиса.
Если вы не умеете программировать, то вместо написания кода можно воспользоваться визуальными конструкторами, например: Aimylogic, Dialogflow, Verter, AlfaBot, AlicePro или PipeBot.
При выборе конструктора стоит обратить внимание на реализацию в нём обработки естественного языка. От неё зависит, будет ли навык реагировать на разные формулировки одного и того же запроса: например, «хочу пиццу», «закажи пиццу» и «сделай заказ».
Кроме того, важно качество интеграции навыка с Яндекс.Диалогами: возможность создания подсказок, адаптации навыка для разных устройств (смартфонов, Станции, Навигатора) и добавления картинок и звуков.

#### Работа в Яндекс.Диалогах
Для того, чтобы создать навык, нужно зарегистрироваться на сайте конструктора и на платформе Яндекс.Диалоги. В Яндекс.Диалогах необходимо добавить диалог с помощью кнопки и выбрать его тип — навык для Алисы.
На странице диалога будет его идентификатор: его нужно скопировать в конструктор, чтобы затем импортировать из него алгоритм.

#### Работа в конструкторе
С помощью визуальных конструкторов можно создавать деревья, которые соответствуют ходу диалога. А переход по ветвям зависит от того, как пользователь будет реагировать на действия навыка.
В навыки можно добавлять кнопки для того, чтобы пользователь мог задавать простые команды не голосом, а быстрым нажатием (например, в отдельную кнопку обычно выносят команду «помощь»). 
Ещё в конструкторах используется метод «HTTP-запрос». С его помощью конструктор может получать данные из внешних источников: например, облачных хранилищ или таблиц. Контент для навыка можно хранить и внутри конструктора, но это усложнит архитектуру диалога и его редактирование — поэтому так делать не стоит.

#### Как опубликовать навык
Для того, чтобы навык можно было использовать любому пользователю, его нужно разместить в каталоге. Чтобы опубликовать диалог, его нужно зарегистрировать в консоли разработчика.
Сперва понадобится задать настройки навыка: название, URL, фразы, активирующие навык, и голос, который он может использовать.
Название навыка для каталога должно состоять не менее чем из двух слов, быть написанным на русском или английском языке и не ограничиваться общей категорией («пластиковые окна» или «путешествия» не подходят). Также имя должно быть уникальным и не содержать слов «Алиса», «Яндекс» или «Станция».
Активационное имя — это фраза, по которой навык можно вызвать в разговоре с Алисой. В этой фразе должна содержаться сокращённая или развёрнутая форма названия: так, для навыка «Верю — не верю» можно использовать имя «играть в верю — не верю».
Голос для озвучивания навыка можно выбрать из специального списка: в него включен как привычный голос Алисы, так и более необычные, например, Эркан Явас — голос, которым озвучиваются Яндекс.Новости.
Ещё перед проверкой нужно выбрать устройства, которые будут поддерживать работу навыка (чтобы модераторы проверили его на всех из них), и протестировать ответы навыка на его странице в личном кабинете.
После того, как вы отправите навык на проверку, результат модерации появится в личном кабинете в течение трех дней. Если навык одобрят, то его можно будет отправить на публикацию кнопкой «опубликовать». А в каталоге навыков Алисы он появится спустя 5–10 минут.


